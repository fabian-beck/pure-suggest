<template>
  <div class="box p-0 m-0 is-radiusless">
    <b-navbar
      :fixed-top="interfaceStore.isMobile"
      class="box p-0 m-0 is-radiusless"
    >
      <template #brand>
        <b-navbar-item>
          <b-icon
            icon="water-plus-outline"
            size="is-medium"
            class="has-text-grey"
          ></b-icon>
          <h1 class="title ml-2">
            <span v-html="$appNameHtml"></span>
          </h1>
        </b-navbar-item>
      </template>
      <template #start>
        <b-navbar-dropdown
          :label="`Session (${sessionStore.selectedPublicationsCount} selected${
            sessionStore.excludedPublicationsCount
              ? `; ${sessionStore.excludedPublicationsCount} excluded`
              : ''
          })`"
          v-show="!sessionStore.isEmpty"
        >
          <b-navbar-item @click="sessionStore.exportSession">
            <b-icon icon="export"></b-icon>
            <span class="ml-2">Export session as JSON</span>
          </b-navbar-item>
          <b-navbar-item @click="sessionStore.exportAllBibtex">
            <b-icon icon="export"></b-icon>
            <span class="ml-2">Export selected as BibTeX</span>
          </b-navbar-item>
          <b-navbar-item
            @click="sessionStore.clearSession"
            class="has-text-danger"
          >
            <b-icon icon="delete"></b-icon
            ><span class="ml-2"><span class="key">C</span>lear session</span>
          </b-navbar-item>
        </b-navbar-dropdown>
      </template>
      <template #end>
        <b-navbar-item>
          <div>
            <finish-study-button />
          </div>
        </b-navbar-item>
        <b-navbar-item tag="div" class="mr-6 ml-1">
          <a href="https://twitter.com/pure_suggest" v-tippy title="Follow us on Twitter">
            <b-icon icon="twitter"></b-icon>
          </a>
          <a href="https://medium.com/@pure_suggest" class="ml-5" v-tippy title="Read more on Medium">
            <b-icon icon="post"></b-icon>
          </a>
          <a href="https://github.com/fabian-beck/pure-suggest" class="ml-5" v-tippy title="Contribute on GitHub">
            <b-icon icon="github"></b-icon>
          </a>
        </b-navbar-item>
        <b-navbar-dropdown
          label="â‹®"
          icon-left="dots-vertical"
          right
          collapsible
        >
          <b-navbar-item @click="interfaceStore.openFeedback">
            <b-icon icon="comment-quote-outline"></b-icon
            ><span class="ml-2">Feedback</span>
          </b-navbar-item>
          <b-navbar-item
            @click="interfaceStore.isKeyboardControlsShown = true"
            class="is-hidden-touch"
          >
            <b-icon icon="keyboard-outline"></b-icon
            ><span class="ml-2">Keyboard controls</span>
          </b-navbar-item>
          <b-navbar-item @click="interfaceStore.isAboutPageShown = true">
            <b-icon icon="information-outline"></b-icon
            ><span class="ml-2">About</span>
          </b-navbar-item>
          <b-navbar-item
            @click="sessionStore.clearCache"
            class="has-text-danger"
          >
            <b-icon icon="cached"></b-icon
            ><span class="ml-2">Clear cache (and session)</span>
          </b-navbar-item>
        </b-navbar-dropdown>
      </template>
    </b-navbar>
    <div class="columns" v-show="sessionStore.isEmpty">
      <div class="column">
        <div class="subtitle level-item mt-2">
          {{ this.$appSubtitle }}
        </div>
      </div>
      <div class="column is-two-thirds">
        <div
          class="notification has-text-centered p-2"
          v-show="sessionStore.isEmpty"
        >
          <p>
            Based on a set of selected publications,
            <b class="has-text-info">suggest</b>ing related
            <b class="has-text-primary">pu</b>blications connected by
            <b class="has-text-primary">re</b>ferences.
          </p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { useSessionStore } from "./../stores/session.js";
import { useInterfaceStore } from "./../stores/interface.js";
import FinishStudyButton from "./FinishStudyButton.vue";

export default {
  name: "HeaderPanel",
  components: { FinishStudyButton },
  setup() {
    const sessionStore = useSessionStore();
    const interfaceStore = useInterfaceStore();
    return { sessionStore, interfaceStore };
  },
  props: {
    isMobile: Boolean,
  },
};
</script>

<style lang="scss" scoped>

.title {
  font-size: $size-4;
}

.subtitle {
  font-size: $size-5;
}

.columns {
  & .column {
    margin: $block-spacing;
  }
}
</style>